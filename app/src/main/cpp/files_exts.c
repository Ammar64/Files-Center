#include "files_exts.h"
#include <stdint.h>
#include <stdlib.h>
#include <string.h>


#define IMAGE_EXTS {\
    "png",\
    "jpg",\
    "jpeg",\
    "webp",\
    "gif",\
    "bmp",\
    "apng",\
    "avif",\
    "tiff",\
    "ico",\
    "cfg"\
}

#define VIDEO_EXTS {\
    "str",\
    "ttml",\
    "rxr",\
    "swf",\
    "aep",\
    "mkv",\
    "pz",\
    "kine",\
    "plot",\
    "prproj",\
    "piv",\
    "sfd",\
    "psv",\
    "plotdoc",\
    "dream",\
    "objection",\
    "ntp",\
    "pic",\
    "anm",\
    "veg",\
    "msdvd",\
    "wlmp",\
    "kmproject",\
    "drp",\
    "aec",\
    "dcr",\
    "amc",\
    "bik",\
    "mswmm",\
    "pac",\
    "mse",\
    "av1",\
    "webm",\
    "kdenlive",\
    "dir",\
    "cine",\
    "ser",\
    "scm",\
    "sub",\
    "fcp",\
    "vpj",\
    "evo",\
    "fbr",\
    "wpl",\
    "dcr",\
    "mp4",\
    "rmvb",\
    "vob",\
    "sbt",\
    "flc",\
    "clpi",\
    "dmx",\
    "srt",\
    "m4s",\
    "ifo",\
    "vp6",\
    "inp",\
    "3gp",\
    "dmsm",\
    "mxf",\
    "cpvc",\
    "vsp",\
    "meta",\
    "camproj",\
    "ivr",\
    "mvd",\
    "vtt",\
    "trp",\
    "mpeg",\
    "wmmp",\
    "m4u",\
    "smv",\
    "mjpg",\
    "rec",\
    "video",\
    "aepx",\
    "swi",\
    "mj2",\
    "mp4v",\
    "amx",\
    "mani",\
    "d3v",\
    "screenflow",\
    "mgv",\
    "rms",\
    "bk2",\
    "vc1",\
    "mepx",\
    "psh",\
    "asf",\
    "flv",\
    "lsav",\
    "mpsub",\
    "ale",\
    "dpa",\
    "tbc",\
    "rcut",\
    "dv",\
    "arcut",\
    "zm2",\
    "jtv",\
    "g2m",\
    "pmf",\
    "siv",\
    "dmsm3d",\
    "gfp",\
    "ncor",\
    "mys",\
    "tvshow",\
    "dv4",\
    "wmv",\
    "mproj",\
    "dxr",\
    "mp4.infovid",\
    "tsv",\
    "mpv",\
    "dat",\
    "xmv",\
    "m1v",\
    "trec",\
    "3gp2",\
    "ts",\
    "cme",\
    "scc",\
    "idx",\
    "mvp",\
    "264",\
    "iva",\
    "m2t",\
    "rm",\
    "m4v",\
    "rcd",\
    "dzm",\
    "bup",\
    "camrec",\
    "zmv",\
    "hdmov",\
    "tix",\
    "dnc",\
    "theater",\
    "dream",\
    "ogv",\
    "mnv",\
    "vro",\
    "stx",\
    "bnp",\
    "awlive",\
    "m2ts",\
    "wp3",\
    "f4p",\
    "ismv",\
    "wvm",\
    "vgz",\
    "dzp",\
    "dvr",\
    "tp",\
    "mpg",\
    "dash",\
    "cpi",\
    "mts",\
    "bdt2",\
    "int",\
    "f4f",\
    "mep",\
    "avv",\
    "ktn",\
    "xyt",\
    "ffd",\
    "fbr",\
    "dzt",\
    "sedprj",\
    "dmb",\
    "vii",\
    "cst",\
    "qtch",\
    "camv",\
    "ppj",\
    "mmp",\
    "movie",\
    "g64",\
    "ircp",\
    "bik2",\
    "projector",\
    "mv",\
    "izz",\
    "zm3",\
    "sfvidcap",\
    "fli",\
    "avb",\
    "dvr-ms",\
    "izzy",\
    "zoom",\
    "bsf",\
    "rdb",\
    "mov",\
    "tivo",\
    "264",\
    "3mm",\
    "pds",\
    "playlist",\
    "wvx",\
    "sbk",\
    "vep",\
    "dav",\
    "ogm",\
    "3g2",\
    "sfera",\
    "dvdmedia",\
    "mvp",\
    "h264",\
    "ogx",\
    "vid",\
    "yuv",\
    "xesc",\
    "60d",\
    "mp2v",\
    "hevc",\
    "xvid",\
    "gts",\
    "san",\
    "d2v",\
    "g64x",\
    "890",\
    "ddat",\
    "mpg4",\
    "mpl",\
    "aaf",\
    "lvix",\
    "jdr",\
    "ism",\
    "f4v",\
    "sqz",\
    "lrv",\
    "exi",\
    "m4f",\
    "vproj",\
    "mp21",\
    "wm",\
    "mvex",\
    "hdv",\
    "mk3d",\
    "jss",\
    "rsx",\
    "dck",\
    "xlmv",\
    "qtl",\
    "moi",\
    "tsp",\
    "divx",\
    "r3d",\
    "lrec",\
    "vcr",\
    "bdmv",\
    "media",\
    "3gpp",\
    "m2p",\
    "nuv",\
    "rv",\
    "wcp",\
    "avchd",\
    "swt",\
    "spl",\
    "k3g",\
    "ced",\
    "wrf",\
    "avi",\
    "tvlayer",\
    "3gpp2",\
    "dpg",\
    "meps",\
    "rum",\
    "pdrproj",\
    "tdt",\
    "pclx",\
    "xml",\
    "exo",\
    "mpe",\
    "prel",\
    "braw",\
    "bu",\
    "3p2",\
    "mp5",\
    "arf",\
    "bdt3",\
    "bmc",\
    "ave",\
    "flic",\
    "nfv",\
    "lsx",\
    "tvs",\
    "moov",\
    "mtv",\
    "tpd",\
    "vp7",\
    "w32",\
    "rmp",\
    "aetx",\
    "dmsd",\
    "aet",\
    "jmv",\
    "wxp",\
    "vcpf",\
    "mvc",\
    "edl",\
    "f4m",\
    "mjp",\
    "qt",\
    "nvc",\
    "vr",\
    "asx",\
    "y4m",\
    "wmd",\
    "imovieproj",\
    "bvr",\
    "irf",\
    "bdm",\
    "ajp",\
    "ftc",\
    "ravi",\
    "mpl",\
    "smil",\
    "avp",\
    "videomeld",\
    "imovielibrary",\
    "prtl",\
    "otrkey",\
    "movie",\
    "tvrecording",\
    "avd",\
    "avs",\
    "m2a",\
    "m2v",\
    "mve",\
    "plproj",\
    "tpr",\
    "m21",\
    "zm1",\
    "sbz",\
    "tp0",\
    "m21",\
    "cmproj",\
    "cmmtpl",\
    "peg",\
    "roq",\
    "flh",\
    "tda3mt",\
    "lfpackage",\
    "hkm",\
    "evo",\
    "fpdx",\
    "sub",\
    "vbc",\
    "ismc",\
    "pxv",\
    "rvid",\
    "rvl",\
    "mpgindex",\
    "vdr",\
    "bmk",\
    "alpx",\
    "pgi",\
    "dvt",\
    "ivf",\
    "amv",\
    "smk",\
    "sdv",\
    "dvx",\
    "vfz",\
    "rcrec",\
    "insv",\
    "n3r",\
    "wtv",\
    "aegraphic",\
    "gxf",\
    "photoshow",\
    "sec",\
    "wmx",\
    "dce",\
    "dad",\
    "par",\
    "ttxt",\
    "pns",\
    "rmd",\
    "yog",\
    "qtm",\
    "wot",\
    "pvr",\
    "nsv",\
    "xel",\
    "crec",\
    "clk",\
    "vix",\
    "thp",\
    "pssd",\
    "fcproject",\
    "pro",\
    "smi",\
    "dv-avi",\
    "xfl",\
    "ffm",\
    "av",\
    "vse",\
    "dif",\
    "ssa",\
    "gifv",\
    "qsv",\
    "vlab",\
    "lvf",\
    "proqc",\
    "blz",\
    "seq",\
    "fcarch",\
    "tod",\
    "vfw",\
    "gcs",\
    "imoviemobile",\
    "m1pg",\
    "bs4",\
    "vs4",\
    "byu",\
    "mod",\
    "kux",\
    "axv",\
    "modd",\
    "mpls",\
    "epv",\
    "viewlet",\
    "qtz",\
    "vdo",\
    "vf",\
    "flx",\
    "jts",\
    "vem",\
    "h265",\
    "pro4dvd",\
    "axp",\
    "el8",\
    "cmv",\
    "dlx",\
    "aecap",\
    "imovieproject",\
    "mxv",\
    "axm",\
    "wsve",\
    "cmmp",\
    "cmrec",\
    "spryzip",\
    "xej",\
    "ezt",\
    "usf",\
    "exp",\
    "smi",\
    "fbz",\
    "moff",\
    "vcv",\
    "dmss",\
    "eyetv",\
    "pva",\
    "avs",\
    "mqv",\
    "wgi",\
    "svi",\
    "eye",\
    "rcproject",\
    "stl",\
    "avr",\
    "rts",\
    "anydesk",\
    "h266",\
    "avs",\
    "vmlt",\
    "drc",\
    "wfsp",\
    "cip",\
    "cam",\
    "qtindex",\
    "avc",\
    "cx3",\
    "vsr",\
    "vp5",\
    "mgjson",\
    "skm",\
    "pro5dvd",\
    "mvy",\
    "dmsd3d",\
    "vmlf",\
    "camtemplate",\
    "anx",\
    "gvp",\
    "mp21",\
    "av3",\
    "rp",\
    "mepj",\
    "sml",\
    "tid",\
    "h263",\
    "pmp",\
    "jnr",\
    "vsh",\
    "vft",\
}

#define AUDIO_EXTS {\
    "sequence",\
    "svp",\
    "fur",\
    "ftm",\
    "abc",\
    "weba",\
    "mtm",\
    "efs",\
    "flp",\
    "tg",\
    "ust",\
    "copy",\
    "sdt",\
    "mp3",\
    "vsq",\
    "ec3",\
    "toc",\
    "sds",\
    "sf2",\
    "asd",\
    "l",\
    "wproj",\
    "sty",\
    "dcf",\
    "mui",\
    "aup",\
    "mka",\
    "flac",\
    "midi",\
    "kt3",\
    "cwb",\
    "rip",\
    "itls",\
    "als",\
    "h5s",\
    "dff",\
    "vpw",\
    "amxd",\
    "mti",\
    "saf",\
    "fsc",\
    "xrns",\
    "vdj",\
    "minigsf",\
    "aria",\
    "cgrp",\
    "acp",\
    "sc2",\
    "cdo",\
    "phy",\
    "rad",\
    "akp",\
    "gsf",\
    "cws",\
    "m4r",\
    "sngx",\
    "pna",\
    "omg",\
    "xmu",\
    "dsm",\
    "xfs",\
    "ptxt",\
    "voxal",\
    "igp",\
    "nki",\
    "slp",\
    "fev",\
    "dct",\
    "dmse",\
    "gp",\
    "mmlp",\
    "sfk",\
    "mid",\
    "band",\
    "4mp",\
    "gsm",\
    "gp5",\
    "rx2",\
    "mscz",\
    "gbs",\
    "apl",\
    "bun",\
    "pek",\
    "ang",\
    "pcg",\
    "rmj",\
    "qcp",\
    "ogg",\
    "acm",\
    "abm",\
    "g726",\
    "vsqx",\
    "wav",\
    "alc",\
    "sfpack",\
    "mmpz",\
    "logicx",\
    "sgp",\
    "afc",\
    "pla",\
    "vlc",\
    "psm",\
    "s3m",\
    "stm",\
    "ovw",\
    "ncw",\
    "acd-zip",\
    "emx",\
    "cue",\
    "dm",\
    "vag",\
    "vyf",\
    "uni",\
    "rns",\
    "act",\
    "uax",\
    "sesx",\
    "ac3",\
    "rol",\
    "vqf",\
    "sseq",\
    "q1",\
    "frg",\
    "zpa",\
    "nrt",\
    "q2",\
    "rmx",\
    "m3u8",\
    "rex",\
    "pkf",\
    "flm",\
    "sib",\
    "aup3",\
    "mxl",\
    "rgrp",\
    "acd",\
    "wfp",\
    "cts",\
    "logic",\
    "aob",\
    "wma",\
    "ptx",\
    "wave",\
    "f32",\
    "cidb",\
    "ckb",\
    "s3i",\
    "sbi",\
    "5xe",\
    "pcast",\
    "pandora",\
    "trak",\
    "sph",\
    "wus",\
    "isma",\
    "mpu",\
    "m4a",\
    "3ga",\
    "at3",\
    "gpk",\
    "swa",\
    "ram",\
    "m3u",\
    "nml",\
    "w01",\
    "med",\
    "yookoo",\
    "oma",\
    "caf",\
    "smf",\
    "xa",\
    "mod",\
    "h5b",\
    "wrk",\
    "mogg",\
    "note",\
    "b4s",\
    "ftmx",\
    "uw",\
    "cwt",\
    "wax",\
    "ins",\
    "m4b",\
    "sdat",\
    "omf",\
    "opus",\
    "ptt",\
    "ftm",\
    "mtp",\
    "wfm",\
    "aif",\
    "mux",\
    "svd",\
    "mus",\
    "nkm",\
    "kmp",\
    "wpp",\
    "oga",\
    "aiff",\
    "669",\
    "mo3",\
    "mus",\
    "rso",\
    "bnk",\
    "xspf",\
    "dmsa",\
    "mpdp",\
    "amf",\
    "wvc",\
    "mbr",\
    "wfb",\
    "mx5template",\
    "lof",\
    "dig",\
    "pts",\
    "vpl",\
    "bdd",\
    "vc3",\
    "brstm",\
    "dsf",\
    "bidule",\
    "iaa",\
    "bnl",\
    "mptm",\
    "cdda",\
    "ssnd",\
    "dss",\
    "dewf",\
    "gpbank",\
    "caff",\
    "sou",\
    "sxt",\
    "nkx",\
    "stap",\
    "rti",\
    "a2p",\
    "h4b",\
    "sd",\
    "ppcx",\
    "rta",\
    "agm",\
    "mx3",\
    "mx4",\
    "ptm",\
    "mtf",\
    "enc",\
    "tak",\
    "cdr",\
    "w64",\
    "cwp",\
    "aa",\
    "cpr",\
    "vox",\
    "bww",\
    "agr",\
    "cda",\
    "ds",\
    "sng",\
    "vpr",\
    "zvd",\
    "wpk",\
    "emd",\
    "aac",\
    "dtshd",\
    "f4a",\
    "bwg",\
    "omx",\
    "mux",\
    "lso",\
    "nwc",\
    "raw",\
    "amr",\
    "vmd",\
    "wve",\
    "mxmf",\
    "ra",\
    "iff",\
    "streamdeckaudio",\
    "musicxml",\
    "gsflib",\
    "pvc",\
    "hca",\
    "dra",\
    "rcy",\
    "rmi",\
    "wtpt",\
    "syw",\
    "u",\
    "syh",\
    "fpa",\
    "mmp",\
    "drg",\
    "ics",\
    "m4p",\
    "vpm",\
    "shn",\
    "nkc",\
    "gpx",\
    "mpa",\
    "dvf",\
    "mdc",\
    "la",\
    "igr",\
    "npl",\
    "nks",\
    "lwv",\
    "8svx",\
    "ab",\
    "wv",\
    "seq",\
    "kar",\
    "ams",\
    "h5e",\
    "uwf",\
    "tak",\
    "mx5",\
    "mdr",\
    "myr",\
    "mpga",\
    "nvf",\
    "obw",\
    "cfa",\
    "mmm",\
    "song",\
    "psf",\
    "ds2",\
    "adt",\
    "xm",\
    "dts",\
    "musx",\
    "odm",\
    "a2m",\
    "avastsounds",\
    "5xb",\
    "all",\
    "vip",\
    "peak",\
    "dls",\
    "dcm",\
    "ots",\
    "msmpl_bank",\
    "vb",\
    "sfas",\
    "conform",\
    "capobundle",\
    "m5p",\
    "koz",\
    "rcd",\
    "koz",\
    "dw",\
    "sppack",\
    "zpl",\
    "rpl",\
    "ssm",\
    "au",\
    "mt2",\
    "psf1",\
    "psf2",\
    "wwu",\
    "pca",\
    "aaxc",\
    "pac",\
    "ksc",\
    "rng",\
    "vgz",\
    "sma",\
    "gbproj",\
    "sfz",\
    "m3up",\
    "ult",\
    "bwf",\
    "wut",\
    "efk",\
    "nsmp",\
    "fzv",\
    "vap",\
    "groove",\
    "ssp",\
    "hsb",\
    "efq",\
    "gig",\
    "g721",\
    "ovex",\
    "hbe",\
    "nsa",\
    "scs11",\
    "fms",\
    "ceol",\
    "nsmpproj",\
    "piximod",\
    "k26",\
    "nksf",\
    "sng",\
    "fzf",\
    "acd-bak",\
    "rsn",\
    "nra",\
    "rdvxz",\
    "slx",\
    "dpdoc",\
    "nmsv",\
    "sap",\
    "syn",\
    "rfl",\
    "amz",\
    "ksf",\
    "ape",\
    "a2b",\
    "pho",\
    "sd",\
    "ptf",\
    "adv",\
    "aax",\
    "mpc",\
    "clp",\
    "pno",\
    "usf",\
    "aifc",\
    "adg",\
    "smp",\
    "miniusf",\
    "csh",\
    "fdp",\
    "mp2",\
    "ove",\
    "tta",\
    "ses",\
    "jam",\
    "sbk",\
    "xmf",\
    "vrf",\
    "snd",\
    "dmf",\
    "mmf",\
    "mts",\
    "r1m",\
    "rvx",\
    "rbs",\
    "psy",\
    "rts",\
    "5xs",\
    "ovw",\
    "prg",\
    "smpx",\
    "snd",\
    "vtx",\
    "sfap0",\
    "voc",\
    "mgv",\
    "bap",\
    "krz",\
    "usflib",\
    "mpd",\
    "kfn",\
    "a2i",\
    "nkb",\
    "smp",\
    "stx",\
    "s3z",\
    "vmo",\
    "bank",\
    "exs",\
    "ntn",\
    "g723",\
    "f64",\
    "adts",\
    "td0",\
    "sd2f",\
    "expressionmap",\
    "ptcop",\
    "rbs",\
    "emp",\
    "wfd",\
    "ams",\
    "snd",\
    "txw",\
    "sfs",\
    "minipsf2",\
    "mte",\
    "ay",\
    "narrative",\
    "sd2",\
    "minipsf",\
    "rax",\
    "a2w",\
    "jspf",\
    "fft",\
    "svx",\
    "repeaks",\
    "wtpl",\
    "ariax",\
    "ofr",\
    "pbf",\
    "jbx",\
    "msv",\
    "vmf",\
    "cel",\
    "cpt",\
    "a2t",\
    "vmf",\
}

#define DOCUMENT_EXTS {\
    "pdf",\
    "doc",\
    "dot",\
    "docx",\
    "dotx",\
    "docm",\
    "dotm",\
    "xls",\
    "xlt",\
    "xla",\
    "xlsx",\
    "xltx",\
    "xlsm",\
    "xltm",\
    "xlam",\
    "xlsb",\
    "ppt",\
    "pot",\
    "pps",\
    "ppa",\
    "pptx",\
    "potx",\
    "ppsx",\
    "ppam",\
    "pptm",\
    "potm",\
    "ppsm",\
    "mdb",\
}
#include <android/log.h>

#define COPY_STRINGS_TO_EXT \
\
int i = 0;\
while(i < *size) {\
    exts[i] = malloc( sizeof(char) * strlen(*strings) + 1 );\
    strcpy( exts[i++], *strings);\
    strings++;\
}

char **getFileExtsForType(int32_t type, int *size) {
    char **exts;

    switch (type) {
        case FILE_TYPE_IMAGE: {
            char *image_exts[] = IMAGE_EXTS;
            *size = sizeof(image_exts) / sizeof(char*);
            exts = malloc(sizeof(image_exts));
            if( exts == NULL ) return NULL;
            char **strings = image_exts;
            COPY_STRINGS_TO_EXT
            break;
        }
        case FILE_TYPE_VIDEO: {
            char *video_exts[] = VIDEO_EXTS;
            *size = sizeof(video_exts) / sizeof(char*);
            exts = malloc(sizeof(video_exts));
            if( exts == NULL ) return NULL;
            char **strings = video_exts;
            COPY_STRINGS_TO_EXT
            break;
        }

        case FILE_TYPE_AUDIO: {
            char *audio_exts[] = AUDIO_EXTS;
            *size = sizeof(audio_exts) / sizeof(char*);
            exts = malloc(sizeof(audio_exts));
            if( exts == NULL ) return NULL;
            char **strings = audio_exts;
            COPY_STRINGS_TO_EXT
            break;
        }
        
        case FILE_TYPE_DOCUMENT: {
            char *document_exts[] = DOCUMENT_EXTS;
            *size = sizeof(document_exts) / sizeof(char*);
            exts = malloc(sizeof(document_exts));
            if( exts == NULL ) return NULL;
            char **strings = document_exts;
            COPY_STRINGS_TO_EXT
            break;
        }
        default:
            return NULL;
    }

    return exts;

}

bool isFileExtinArray(const char *filename, char **exts, int exts_len) {
    int dotIndex = -1;
    const char *s;
    for (s = filename; *s; ++s){
        if( *s == '.' ) {
            dotIndex = s - filename + 1;
        }
    }
    int size = (s - filename);

    if( dotIndex == size ||
        dotIndex == -1  ) return false; // safety first

    const char *ext = filename + dotIndex;

    bool found = false;
    for(int i = 0; i < exts_len ; i++) {
        found |= !strcmp(ext, exts[i]);
        free(exts[i]);
    }
    free(exts);
    return found;
}